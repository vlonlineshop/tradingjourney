<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Trading Dashboard</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 2rem;
      color: #333;
    }

    h1 {
      text-align: center;
      margin-bottom: 2rem;
    }

    .section {
      background: white;
      padding: 1.5rem;
      margin-bottom: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    form label {
      margin-right: 1rem;
    }

    input {
      padding: 0.5rem;
      margin: 0.3rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    button {
      padding: 0.5rem 1rem;
      background-color: #007bff;
      border: none;
      color: white;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }

    th, td {
      padding: 0.75rem;
      border: 1px solid #ddd;
      text-align: center;
    }

    th {
      background-color: #f0f0f0;
    }

    .summary p {
      font-size: 1.1rem;
      margin: 0.5rem 0;
    }

    .reset-btn {
      margin-top: 1rem;
      background-color: #dc3545;
    }

    .reset-btn:hover {
      background-color: #a71d2a;
    }

    @media (max-width: 768px) {
      form {
        display: flex;
        flex-direction: column;
      }

      form label {
        margin-bottom: 0.5rem;
      }
    }
  </style>
</head>
<body>

  <h1>Trading Dashboard</h1>

  <div class="section">
    <h2>Input Trade Baru</h2>
    <form id="tradeForm">
      <label>Pair: <input type="text" id="pair" required></label>
      <label>Lot: <input type="number" id="lot" step="0.01" required></label>
      <label>Entry: <input type="number" id="entry" required></label>
      <label>TP: <input type="number" id="tp"></label>
      <label>SL: <input type="number" id="sl"></label>
      <button type="submit">Tambah Trade</button>
    </form>
  </div>

  <div class="section">
    <h2>Trade Aktif</h2>
    <table>
      <thead>
        <tr>
          <th>Pair</th>
          <th>Lot</th>
          <th>Entry</th>
          <th>TP</th>
          <th>SL</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="tradeList"></tbody>
    </table>
  </div>

  <div class="section">
    <h2>Riwayat Trade</h2>
    <table>
      <thead>
        <tr>
          <th>Pair</th>
          <th>Lot</th>
          <th>Entry</th>
          <th>TP</th>
          <th>SL</th>
          <th>Waktu Close</th>
        </tr>
      </thead>
      <tbody id="tradeHistory"></tbody>
    </table>
  </div>

  <div class="section summary">
    <h2>Ringkasan</h2>
    <p>‚úÖ Win: <span id="winCounter">0</span></p>
    <p>‚ùå Loss: <span id="lossCounter">0</span></p>
    <p>üí∞ Saldo Akhir: $<span id="finalBalance">0</span></p>
    <button class="reset-btn" onclick="resetAllData()">Reset Semua</button>
  </div>

  <script>
    // Form submit handler
    document.getElementById("tradeForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const pair = document.getElementById("pair").value;
      const lot = parseFloat(document.getElementById("lot").value);
      const entry = document.getElementById("entry").value;
      const tp = document.getElementById("tp").value || "-";
      const sl = document.getElementById("sl").value || "-";

      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${pair}</td>
        <td>${lot}</td>
        <td>${entry}</td>
        <td>${tp}</td>
        <td>${sl}</td>
        <td><button onclick="closeTrade(this)">Close</button></td>
      `;
      document.getElementById("tradeList").appendChild(row);

      document.getElementById("tradeForm").reset();
      saveToLocalStorage();
    });

    function closeTrade(button) {
      const row = button.closest("tr");
      const cells = row.querySelectorAll("td");
      const pair = cells[0].textContent;
      const lot = parseFloat(cells[1].textContent);
      const entry = cells[2].textContent;
      const tp = cells[3].textContent;
      const sl = cells[4].textContent;
      const closeTime = new Date().toLocaleString();

      const historyRow = document.createElement("tr");
      historyRow.innerHTML = `
        <td>${pair}</td>
        <td>${lot}</td>
        <td>${entry}</td>
        <td>${tp}</td>
        <td>${sl}</td>
        <td>${closeTime}</td>
      `;
      document.getElementById("tradeHistory").appendChild(historyRow);

      // Simulasi win/loss
      const isWin = Math.random() > 0.5;
      const profit = isWin ? lot * 10 : -lot * 10;

      const balanceEl = document.getElementById("finalBalance");
      balanceEl.textContent = (parseFloat(balanceEl.textContent) + profit).toFixed(2);

      const counter = document.getElementById(isWin ? "winCounter" : "lossCounter");
      counter.textContent = parseInt(counter.textContent) + 1;

      row.remove();
      saveToLocalStorage();
    }

    function saveToLocalStorage() {
      const openTrades = [];
      document.querySelectorAll("#tradeList tr").forEach(row => {
        const cells = row.querySelectorAll("td");
        openTrades.push({
          pair: cells[0].textContent,
          lot: cells[1].textContent,
          entry: cells[2].textContent,
          tp: cells[3].textContent,
          sl: cells[4].textContent
        });
      });

      localStorage.setItem("openTrades", JSON.stringify(openTrades));
      localStorage.setItem("tradeHistory", document.getElementById("tradeHistory").innerHTML);
      localStorage.setItem("finalBalance", document.getElementById("finalBalance").textContent);
      localStorage.setItem("winCounter", document.getElementById("winCounter").textContent);
      localStorage.setItem("lossCounter", document.getElementById("lossCounter").textContent);
    }

    function loadFromLocalStorage() {
      const trades = JSON.parse(localStorage.getItem("openTrades"));
      const historyHTML = localStorage.getItem("tradeHistory");
      const balance = localStorage.getItem("finalBalance");
      const win = localStorage.getItem("winCounter");
      const loss = localStorage.getItem("lossCounter");

      if (trades) {
        trades.forEach(trade => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${trade.pair}</td>
            <td>${trade.lot}</td>
            <td>${trade.entry}</td>
            <td>${trade.tp}</td>
            <td>${trade.sl}</td>
            <td><button onclick="closeTrade(this)">Close</button></td>
          `;
          document.getElementById("tradeList").appendChild(row);
        });
      }

      if (historyHTML) document.getElementById("tradeHistory").innerHTML = historyHTML;
      if (balance) document.getElementById("finalBalance").textContent = balance;
      if (win) document.getElementById("winCounter").textContent = win;
      if (loss) document.getElementById("lossCounter").textContent = loss;
    }

    function resetAllData() {
      localStorage.clear();
      location.reload();
    }

    document.addEventListener("DOMContentLoaded", loadFromLocalStorage);
  </script>
</body>
</html>
